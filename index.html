<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="Asciidoctor 0.1.4">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scala&#8217;s Types of Types</title>
<style>
@import url(http://cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.0/css/font-awesome.css);
/*! normalize.css v2.1.1 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address styling not present in IE 8/9. */
[hidden] { display: none; }

/* ========================================================================== Base ========================================================================== */
/** 1. Prevent system color scheme's background color being used in Firefox, IE, and Opera. 2. Prevent system color scheme's text color being used in Firefox, IE, and Opera. 3. Set default font family to sans-serif. 4. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { background: #fff; /* 1 */ color: #000; /* 2 */ font-family: sans-serif; /* 3 */ -ms-text-size-adjust: 100%; /* 4 */ -webkit-text-size-adjust: 100%; /* 4 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

a:focus { outline: none; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased, body { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, #content #toctitle, .admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .mathblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title, .tableblock > caption { line-height: 1.4; color: #6f6f6f; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #2ba6cb; text-decoration: none; line-height: inherit; }
a:hover, a:focus { color: #2795b6; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: bold; font-style: normal; color: #222222; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #6f6f6f; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: bold; color: #7f0a0c; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }

blockquote, blockquote p { line-height: 1.6; color: #6f6f6f; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Print styles.  Inlined to avoid required HTTP connection: www.phpied.com/delay-loading-your-print-css/ Credit to Paul Irish and HTML5 Boilerplate (html5boilerplate.com)
*/
.print-only { display: none !important; }

@media print { * { background: transparent !important; color: #000 !important; /* Black prints faster: h5bp.com/s */ box-shadow: none !important; text-shadow: none !important; }
  a, a:visited { text-decoration: underline; }
  a[href]:after { content: " (" attr(href) ")"; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after { content: ""; }
  pre, blockquote { border: 1px solid #999; page-break-inside: avoid; }
  thead { display: table-header-group; /* h5bp.com/t */ }
  tr, img { page-break-inside: avoid; }
  img { max-width: 100% !important; }
  @page { margin: 0.5cm; }
  p, h2, h3, #toctitle, .sidebarblock > .content > .title { orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; padding: 0; white-space: nowrap; background-color: inherit; border: 0 solid #dddddd; -webkit-border-radius: 0; border-radius: 0; text-shadow: none; }

pre, pre > code { line-height: 1.4; color: black; font-family: monospace, serif; font-weight: normal; }

kbd.keyseq { color: #555555; }

kbd:not(.keyseq) { display: inline-block; color: #222222; font-size: 0.75em; line-height: 1.4; background-color: #F7F7F7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }

kbd kbd:first-child { margin-left: 0; }

kbd kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: #090909; }

b.button:before { content: '[ '; }

b.button:after { content: ' ]'; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#header { margin-bottom: 2.5em; }
#header > h1 { color: black; font-weight: bold; border-bottom: 1px solid #dddddd; margin-bottom: -28px; padding-bottom: 32px; }
#header span { color: #6f6f6f; }
#header #revnumber { text-transform: capitalize; }
#header br { display: none; }
#header br + span { padding-left: 3px; }
#header br + span:before { content: "\2013 \0020"; }
#header br + span.author { padding-left: 0; }
#header br + span.author:before { content: ", "; }

#toc { border-bottom: 1px solid #dddddd; padding-bottom: 1.25em; }
#toc > ul { margin-left: 0.25em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
#toc ul { list-style-type: none; }

#toctitle { color: #6f6f6f; }

@media only screen and (min-width: 768px) { body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #dddddd; border-bottom: 0; z-index: 1000; padding: 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: .90em; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; border-width: 0; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }
#content #toc a { text-decoration: none; }

#content #toctitle { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-size: 1em; padding-left: 0.125em; }

#footer { max-width: 100%; background-color: #222222; padding: 1.25em; }

#footer-text { color: #dddddd; line-height: 1.44; }

.sect1 { padding-bottom: 1.25em; }

.sect1 + .sect1 { border-top: 1px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; width: 1em; margin-left: -1em; display: block; text-decoration: none; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: '\00A7'; font-size: .85em; vertical-align: text-top; display: block; margin-top: 0.05em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #222222; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #151515; }

.imageblock, .literalblock, .listingblock, .mathblock, .verseblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .mathblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-align: left; font-weight: bold; }

.tableblock > caption { text-align: left; font-weight: bold; white-space: nowrap; overflow: visible; max-width: 0; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #6f6f6f; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6, .exampleblock > .content p { color: #333333; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6 { line-height: 1; margin-bottom: 0.625em; }
.exampleblock > .content h1.subheader, .exampleblock > .content h2.subheader, .exampleblock > .content h3.subheader, .exampleblock > .content .subheader#toctitle, .sidebarblock.exampleblock > .content > .subheader.title, .exampleblock > .content h4.subheader, .exampleblock > .content h5.subheader, .exampleblock > .content h6.subheader { line-height: 1.4; }

.exampleblock.result > .content { -webkit-box-shadow: 0 1px 8px #d9d9d9; box-shadow: 0 1px 8px #d9d9d9; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6, .sidebarblock p { color: #333333; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6 { line-height: 1; margin-bottom: 0.625em; }
.sidebarblock h1.subheader, .sidebarblock h2.subheader, .sidebarblock h3.subheader, .sidebarblock .subheader#toctitle, .sidebarblock > .content > .subheader.title, .sidebarblock h4.subheader, .sidebarblock h5.subheader, .sidebarblock h6.subheader { line-height: 1.4; }
.sidebarblock > .content > .title { color: #6f6f6f; margin-top: 0; line-height: 1.6; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock > .content pre, .listingblock > .content pre { background: #eeeeee; border-width: 1px; border-style: solid; border-color: #cccccc; -webkit-border-radius: 0; border-radius: 0; padding: 0.8em 0.8em 0.65em 0.8em; word-wrap: break-word; }
.literalblock > .content pre.nowrap, .listingblock > .content pre.nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
.literalblock > .content pre > code, .listingblock > .content pre > code { display: block; }
@media only screen { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.72em; } }
@media only screen and (min-width: 768px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.81em; } }
@media only screen and (min-width: 1280px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.9em; } }

.listingblock > .content { position: relative; }

.listingblock:hover code[class*=" language-"]:before { text-transform: uppercase; font-size: 0.9em; color: #999; position: absolute; top: 0.375em; right: 0.375em; }

.listingblock:hover code.asciidoc:before { content: "asciidoc"; }
.listingblock:hover code.clojure:before { content: "clojure"; }
.listingblock:hover code.css:before { content: "css"; }
.listingblock:hover code.groovy:before { content: "groovy"; }
.listingblock:hover code.html:before { content: "html"; }
.listingblock:hover code.java:before { content: "java"; }
.listingblock:hover code.javascript:before { content: "javascript"; }
.listingblock:hover code.python:before { content: "python"; }
.listingblock:hover code.ruby:before { content: "ruby"; }
.listingblock:hover code.sass:before { content: "sass"; }
.listingblock:hover code.scss:before { content: "scss"; }
.listingblock:hover code.xml:before { content: "xml"; }
.listingblock:hover code.yaml:before { content: "yaml"; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: '$'; }

table.pyhltable { border: 0; margin-bottom: 0; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

.highlight.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }

.highlight.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background-color: transparent !important; padding-right: 0 !important; }

.quoteblock { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
.quoteblock blockquote { margin: 0 0 1.25em 0; padding: 0 0 0.5625em 0; border: 0; }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: -.25em; padding-bottom: 0.5625em; font-size: 0.8125em; color: #555555; }
.quoteblock .attribution br { display: none; }
.quoteblock .attribution cite { display: block; margin-bottom: 0.625em; }

table thead th, table tfoot th { font-weight: bold; }

table.tableblock.grid-all { border-collapse: separate; border-spacing: 1px; -webkit-border-radius: 0; border-radius: 0; border-top: 1px solid #dddddd; border-bottom: 1px solid #dddddd; }

table.tableblock.frame-topbot, table.tableblock.frame-none { border-left: 0; border-right: 0; }

table.tableblock.frame-sides, table.tableblock.frame-none { border-top: 0; border-bottom: 0; }

table.tableblock td .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

th.tableblock.halign-left, td.tableblock.halign-left { text-align: left; }

th.tableblock.halign-right, td.tableblock.halign-right { text-align: right; }

th.tableblock.halign-center, td.tableblock.halign-center { text-align: center; }

th.tableblock.valign-top, td.tableblock.valign-top { vertical-align: top; }

th.tableblock.valign-bottom, td.tableblock.valign-bottom { vertical-align: bottom; }

th.tableblock.valign-middle, td.tableblock.valign-middle { vertical-align: middle; }

tbody tr th { display: table-cell; line-height: 1.4; background: whitesmoke; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #222222; font-weight: bold; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > i[class^="icon-check"]:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1 { padding-right: .8em; font-weight: bold; }

td.hdlist1, td.hdlist2 { vertical-align: top; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 .8em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.qanda > ol > li > p > em:only-child { color: #2795b6; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; }

span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }

#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: none; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > [class^="icon-"], span.icon > [class*=" icon-"] { cursor: default; }

.admonitionblock td.icon [class^="icon-"]:before { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #2ba6cb; color: #207c98; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum { display: inline-block; color: white !important; background-color: #222222; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; width: 20px; height: 20px; font-size: 12px; font-weight: bold; line-height: 20px; font-family: Arial, sans-serif; font-style: normal; position: relative; top: -2px; letter-spacing: -1px; }
.conum * { color: white !important; }
.conum + b { display: none; }
.conum:after { content: attr(data-value); }
.conum:not([data-value]):empty { display: none; }
</style>
<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.1/css/font-awesome.min.css">
<style>
.highlight .hll { background-color: #ffffcc }
.highlight  { background: #ffffff; }
.highlight .tok-c { color: #888888 } /* Comment */
.highlight .tok-err { color: #a61717; background-color: #e3d2d2 } /* Error */
.highlight .tok-k { color: #008800; font-weight: bold } /* Keyword */
.highlight .tok-cm { color: #888888 } /* Comment.Multiline */
.highlight .tok-cp { color: #cc0000; font-weight: bold } /* Comment.Preproc */
.highlight .tok-c1 { color: #888888 } /* Comment.Single */
.highlight .tok-cs { color: #cc0000; font-weight: bold; background-color: #fff0f0 } /* Comment.Special */
.highlight .tok-gd { color: #000000; background-color: #ffdddd } /* Generic.Deleted */
.highlight .tok-ge { font-style: italic } /* Generic.Emph */
.highlight .tok-gr { color: #aa0000 } /* Generic.Error */
.highlight .tok-gh { color: #333333 } /* Generic.Heading */
.highlight .tok-gi { color: #000000; background-color: #ddffdd } /* Generic.Inserted */
.highlight .tok-go { color: #888888 } /* Generic.Output */
.highlight .tok-gp { color: #555555 } /* Generic.Prompt */
.highlight .tok-gs { font-weight: bold } /* Generic.Strong */
.highlight .tok-gu { color: #666666 } /* Generic.Subheading */
.highlight .tok-gt { color: #aa0000 } /* Generic.Traceback */
.highlight .tok-kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .tok-kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .tok-kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .tok-kp { color: #008800 } /* Keyword.Pseudo */
.highlight .tok-kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .tok-kt { color: #888888; font-weight: bold } /* Keyword.Type */
.highlight .tok-m { color: #0000DD; font-weight: bold } /* Literal.Number */
.highlight .tok-s { color: #dd2200; background-color: #fff0f0 } /* Literal.String */
.highlight .tok-na { color: #336699 } /* Name.Attribute */
.highlight .tok-nb { color: #003388 } /* Name.Builtin */
.highlight .tok-nc { color: #bb0066; font-weight: bold } /* Name.Class */
.highlight .tok-no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .tok-nd { color: #555555 } /* Name.Decorator */
.highlight .tok-ne { color: #bb0066; font-weight: bold } /* Name.Exception */
.highlight .tok-nf { color: #0066bb; font-weight: bold } /* Name.Function */
.highlight .tok-nl { color: #336699; font-style: italic } /* Name.Label */
.highlight .tok-nn { color: #bb0066; font-weight: bold } /* Name.Namespace */
.highlight .tok-py { color: #336699; font-weight: bold } /* Name.Property */
.highlight .tok-nt { color: #bb0066; font-weight: bold } /* Name.Tag */
.highlight .tok-nv { color: #336699 } /* Name.Variable */
.highlight .tok-ow { color: #008800 } /* Operator.Word */
.highlight .tok-w { color: #bbbbbb } /* Text.Whitespace */
.highlight .tok-mf { color: #0000DD; font-weight: bold } /* Literal.Number.Float */
.highlight .tok-mh { color: #0000DD; font-weight: bold } /* Literal.Number.Hex */
.highlight .tok-mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .tok-mo { color: #0000DD; font-weight: bold } /* Literal.Number.Oct */
.highlight .tok-sb { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .tok-sc { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Char */
.highlight .tok-sd { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Doc */
.highlight .tok-s2 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Double */
.highlight .tok-se { color: #0044dd; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .tok-sh { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .tok-si { color: #3333bb; background-color: #fff0f0 } /* Literal.String.Interpol */
.highlight .tok-sx { color: #22bb22; background-color: #f0fff0 } /* Literal.String.Other */
.highlight .tok-sr { color: #008800; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .tok-s1 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Single */
.highlight .tok-ss { color: #aa6600; background-color: #fff0f0 } /* Literal.String.Symbol */
.highlight .tok-bp { color: #003388 } /* Name.Builtin.Pseudo */
.highlight .tok-vc { color: #336699 } /* Name.Variable.Class */
.highlight .tok-vg { color: #dd7700 } /* Name.Variable.Global */
.highlight .tok-vi { color: #3333bb } /* Name.Variable.Instance */
.highlight .tok-il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */
</style>
</head>
<body class="article toc2 toc-right">
<div id="header">
<h1>Scala&#8217;s Types of Types</h1>
<span id="author" class="author">Konrad 'ktoso' Malawski &lt;konrad.malawski@java.pl&gt;</span><br>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#the-different-types-of-types-in-scala">The different types of&#8230; Types in Scala</a></li>
<li><a href="#type-annotation">Type Annotation</a></li>
<li><a href="#unified-type-system-any-anyref-anyval">Unified Type System - Any, AnyRef, AnyVal</a></li>
<li><a href="#the-bottom-types-nothing-and-null">The Bottom Types - Nothing and Null</a></li>
<li><a href="#type-of-an-code-object-code">Type of an <code>object</code></a></li>
<li><a href="#type-variance-in-scala">Type Variance in Scala</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#traits-as-in-interfaces-with-implementation">Traits, as in "interfaces with implementation"</a></li>
<li><a href="#type-linearization-vs-the-diamond-problem">Type Linearization vs. The Diamond Problem</a></li>
</ul>
</li>
<li><a href="#refined-types-refinements">Refined Types (refinements)</a></li>
<li><a href="#type-alias">Type Alias</a></li>
<li><a href="#abstract-type-member">Abstract Type Member</a></li>
<li><a href="#self-recursive-type">Self-Recursive Type</a></li>
<li><a href="#type-class">Type Class</a></li>
<li><a href="#type-constructor">Type Constructor</a></li>
<li><a href="#self-type-annotation">Self Type Annotation</a></li>
<li><a href="#phantom-type">Phantom Type</a></li>
<li><a href="#structural-type">Structural Type</a></li>
<li><a href="#path-dependent-type">Path Dependent Type</a></li>
<li><a href="#type-projection">Type Projection</a></li>
<li><a href="#existential-types">Existential Types</a></li>
<li><a href="#dynamic-type">Dynamic Type</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#applydynamic">applyDynamic</a></li>
<li><a href="#applydynamicnamed">applyDynamicNamed</a></li>
<li><a href="#selectdynamic">selectDynamic</a></li>
<li><a href="#updatedynamic">updateDynamic</a></li>
</ul>
</li>
<li><a href="#type-lambda">Type Lambda</a></li>
<li><a href="#links-and-kudos">Links and Kudos</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="the-different-types-of-types-in-scala"><a class="anchor" href="#the-different-types-of-types-in-scala"></a>The different types of&#8230; Types in Scala</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This blog post came into being after a few discussions about Types in Scala after some of JavaOne&#8217;s parties in 2013. After those discussions I figured that many questions are often repeated by different people, during their learning of Scala. I though that we didn&#8217;t have a full list of all tricks what we can to with Types in Scala, so I decided to write such a list - giving real life examples why we&#8217;d need these types.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="type-annotation"><a class="anchor" href="#type-annotation"></a>Type Annotation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Scala has Type Inference, which means that we can skip telling the Type of something each time in the source code,
and instead we just use `val`s or `def`s without "saying the type explicitly in the source". This being explicit about
the type of something, is called an Type Annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">trait</span> <span class="tok-nc">Thing</span>
<span class="tok-k">def</span> <span class="tok-n">getThing</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">Thing</span>

<span class="tok-c1">// without Type Annotation, the type is infered to be `Thing`</span>
<span class="tok-k">val</span> <span class="tok-n">infered</span> <span class="tok-k">=</span> <span class="tok-n">getThing</span>

<span class="tok-c1">// with Type Annotation</span>
<span class="tok-k">val</span> <span class="tok-n">thing</span><span class="tok-k">:</span> <span class="tok-kt">Thing</span> <span class="tok-o">=</span> <span class="tok-n">getThing</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>In these situations, leaving out the Type Annotation is OK. Although you may decide to always annotate return types of public methods (<strong>that&#8217;s very good idea!</strong>) in order to make the code more self-documenting.</p>
</div>
<div class="paragraph">
<p>In case of doubt you can refer to the below hint-questions to wether or not, include a Type Annotation.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It it a parameter? <strong>Yes</strong>, you have to.</p>
</li>
<li>
<p>Is it a public methods return value? <strong>Yes</strong>, for self-documenting code and control over exported types.</p>
</li>
<li>
<p>Do you need to return a more general interface than the inferencer would find? <strong>Yes</strong>, otherwise you&#8217;d expose your implementation details for example.</p>
</li>
<li>
<p>Else&#8230; No, don&#8217;t include a Type Annotation.</p>
</li>
<li>
<p>Related hint: Including Type Annotations speeds up compilation, also it&#8217;s generally nice to see the return type of a method.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So we put Type Annotations after value names. Having this said, let&#8217;s jump into the next topics, where these types will become
more and more interesting.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="unified-type-system-any-anyref-anyval"><a class="anchor" href="#unified-type-system-any-anyref-anyval"></a>Unified Type System - Any, AnyRef, AnyVal</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We refer to a Scala&#8217;s typesystem as being "unified" because there is a "Top Type", <code>Any</code>. <strong>This is different than Java</strong>, which has "special cases" in form of primitive types (<code>int</code>, <code>long</code>, <code>float</code>, <code>double</code>, <code>byte</code>, <code>char</code>, <code>short</code>, <code>boolean</code>), which do not extend Java&#8217;s "Almost-Top Type" - <code>java.lang.Object</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="http://www.blog.project13.pl/wp-content/uploads/2012/12/skitch-5.png" alt="Unified Type System">
</div>
</div>
<div class="paragraph">
<p>Scala takes on the idea of having one common Top Type for all Types by introducing <code>Any</code>. <code>Any</code> is a supertype of both <code>AnyRef</code> and <code>AnyVal</code>.</p>
</div>
<div class="paragraph">
<p><code>AnyRef</code> is the "object world" of Java (and the JVM), it corresponds to <code>java.lang.Object</code>, and is the supertype of all objects.</p>
</div>
<div class="paragraph">
<p><code>AnyVal</code> represents the "value world" of Java, such as <code>int</code> and it&#8217;s friends.</p>
</div>
<div class="paragraph">
<p>Thanks to this hierarchy, we&#8217;re able to define methods taking <code>Any</code> - thus being compatible with both <code>scala.Int</code> instances as well as <code>java.lang.String</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">class</span> <span class="tok-nc">Person</span>

<span class="tok-k">val</span> <span class="tok-n">allThings</span> <span class="tok-k">=</span> <span class="tok-nc">ArrayBuffer</span><span class="tok-o">[</span><span class="tok-kt">Any</span><span class="tok-o">]()</span>

<span class="tok-k">val</span> <span class="tok-n">myInt</span> <span class="tok-k">=</span> <span class="tok-mi">42</span>             <span class="tok-c1">// Int, kept as low-level `int` during runtime</span>

<span class="tok-n">allThings</span> <span class="tok-o">+=</span> <span class="tok-n">myInt</span>         <span class="tok-c1">// Int (extends AnyVal)</span>
                           <span class="tok-c1">// has to be boxed (!) -&gt; becomes java.lang.Integer in the collection (!)</span>

<span class="tok-n">allThings</span> <span class="tok-o">+=</span> <span class="tok-k">new</span> <span class="tok-nc">Person</span><span class="tok-o">()</span>  <span class="tok-c1">// Person (extends AnyRef), no magic here</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the Typesystem it&#8217;s transparent, though on the JVM level once we get into <code>ArrayBuffer[Any]</code> our Int instances will have to be packed into objects. Let&#8217;s investigate the above example&#8217;s by using the Scala REPL and it&#8217;s <code>:javap</code> command (which shows the generated bytecode for our test class):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="asciidoc language-asciidoc">35: invokevirtual #47  // Method myInt:()I
38: invokestatic  #53  // Method scala/runtime/BoxesRunTime.boxToInteger:(I)Ljava/lang/Integer;
41: invokevirtual #57  // Method scala/collection/mutable/ArrayBuffer.$plus$eq:(Ljava/lang/Object;)Lscala/collection/mutable/ArrayBuffer;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You&#8217;ll notive that <code>myInt</code> is still carrying the value of a <code>int primitive</code> (this is visible as <code>I</code> at the end of the <code>myInt:()I</code> <strong>invokevirtual</strong> call). Then, right before adding it to the ArrayBuffer, scalac inserted a call to <code>BoxesRunTime.boxToInteger:(I)Ljava/lang/Integer</code> (a small hint for not frequent bytecode readers, the method it calls is: <code>public Integer boxToInteger(i: int)</code>). This way, by having a smart compiler and treating everything as an object in this common hierarchy we&#8217;re able to get away from the "but primitives are different" edge-cases, at least at the level of our Scala source code - the compiler takes care of it for us. On JVM level, the distinction is still there of course, and scalac will do it&#8217;s best to keep using primitives wherever possible, as operations on them are faster, and take less memory (objects are obviously bigger than primitives).</p>
</div>
<div class="paragraph">
<p>On the other hand, we can limit a method to only be able to work on "lightweight" Value Types:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">def</span> <span class="tok-n">check</span><span class="tok-o">(</span><span class="tok-n">in</span><span class="tok-k">:</span> <span class="tok-kt">AnyVal</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-o">()</span>

<span class="tok-n">check</span><span class="tok-o">(</span><span class="tok-mi">42</span><span class="tok-o">)</span>    <span class="tok-c1">// Int -&gt; AnyVal</span>
<span class="tok-n">check</span><span class="tok-o">(</span><span class="tok-mf">13.37</span><span class="tok-o">)</span> <span class="tok-c1">// Double -&gt; AnyVal</span>

<span class="tok-n">check</span><span class="tok-o">(</span><span class="tok-k">new</span> <span class="tok-nc">Object</span><span class="tok-o">)</span> <span class="tok-c1">// -&gt; AnyRef = fails to compile</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example I&#8217;ve used a TypeClass <code>Checker[T]</code> and a type bound, which will be discussed below. The general idea is that this method will only take value classes, be it Int or our own Value Type. While probably not used very often, it shows how nicely the typesystem embraces java primitives, and brings them into the "real" type system, and not as a separate case, as is the case with Java.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="the-bottom-types-nothing-and-null"><a class="anchor" href="#the-bottom-types-nothing-and-null"></a>The Bottom Types - Nothing and Null</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Scala everything has "some" type&#8230; but have you ever wondered how the type inferencer can still work, and infer sound types when working with "weird" situations like throwing exceptions? Let&#8217;s investigate the below "if/else throw" example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="asciidoc language-asciidoc">val thing: Int =
  if (test)
    42                             // : Int
  else
    throw new Exception("Whoops!") // : Nothing</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see in the comments, the type of the if block is <code>Int</code> (easy), the type of the else block is <code>Nothing</code> (interresting). The inferencer was able to infer that the <code>thing</code> value, will only ever be of type <code>Int</code>. This is because of the <strong>Bottom Type</strong> property of Nothing. You can think of it as if:</p>
</div>
<div class="paragraph">
<p>"<code>Nothing extends anything</code>"</p>
</div>
<div class="paragraph">
<p>Type inference always looks for the "common type" of both branches in an if stamement, so if the other branch here is a Type that extends everything, the infered type will automatically be the Type from the first branch.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="asciidoc language-asciidoc">Types visualized:

           [Int] -> ... -> AnyVal -> Anything
Nothing -> [Int] -> ... -> AnyVal -> Any</code></pre>
</div>
</div>
<div class="paragraph">
<p>The same reasoning can be applied to the second Bottom Type in Scala - <code>Null</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="asciidoc language-asciidoc">val thing: String =
  if (test)
    "Yay!"  // : String
  else
  	null    // : Null</code></pre>
</div>
</div>
<div class="paragraph">
<p>The type of <code>thing</code> is as expected, String. <code>Null</code> follows ALMOST the same rules as Nothing. I&#8217;ll use this case to take a small detour to talk about inference, and the differences between AnyVals and AnyRefs.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="asciidoc language-asciidoc">Types visualized:

        [String] -> AnyRef -> Any
Null -> [String] -> AnyRef -> Any

infered type: String</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s think about <code>Int</code> and other primitives, which cannot hold null values. To investigate this case let&#8217;s drop into the REPL and use the <code>:type</code> command (which allows to get the type of an expression):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="asciidoc language-asciidoc">scala> :type if (false) 23 else null
Any</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is different than the case with a String object in one of the branches. Let&#8217;s look into the types in detail here, as <code>Null</code> is a bit less "extends everything" than <code>Nothing</code>. Let&#8217;s see what <code>Int</code> extends in detail, by using <code>:type</code> again on it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="asciidoc language-asciidoc">scala> :type -v 12
// Type signature
Int

// Internal Type structure
TypeRef(TypeSymbol(final abstract class Int extends AnyVal))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The verbose option adds a bit more information here, now we know that <code>Int</code> is an <code>AnyVal</code> - this is a special class representing value types - which cannot hold <code>Null</code>. If we look into &lt;a href="https://github.com/scala/scala/blob/v2.10.3/src/library/scala/AnyVal.scala"&gt;AnyVal&#8217;s sources&lt;/a&gt;, we&#8217;ll find:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="asciidoc language-asciidoc">abstract class AnyVal extends Any with NotNull</code></pre>
</div>
</div>
<div class="paragraph">
<p>I&#8217;m bringing this up here because the core functionality of AnyVal is so nicely represented using the Types here. <strong>Notice the <code>NotNull</code> trait!</strong></p>
</div>
<div class="paragraph">
<p>Coming back to the subject why the common Type for our if statement with an <code>AnyVal</code> on one code block and a <code>null</code> on the other one was Any and not something else. The one sentence way to define it is: <code>Null extends all AnyRefs</code> whereas <code>Nothing extends anything</code>. As AnyVals (such as numbers), are not in the same tree as AnyRefs, the only common Type between a number and a <code>null</code> value is Any - which explains our case.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="asciidoc language-asciidoc">Types visualized:

Int  -> NotNull -> AnyVal -> [Any]
Null            -> AnyRef -> [Any]

infered type: Any</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="type-of-an-code-object-code"><a class="anchor" href="#type-of-an-code-object-code"></a>Type of an <code>object</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Scala `object`s are implemented via classes (obviously - as it&#8217;s the basic building block on the JVM),
but you&#8217;ll notice that we cannot get it&#8217;s type the same way as we would with an simple class&#8230;</p>
</div>
<div class="paragraph">
<p>I surprisingly often, would get the question on how to pass an object into a method. Just saying <code>obj: ExampleObj</code> won&#8217;t work
because that&#8217;s already referring to the instance, so there&#8217;s a member called <code>type</code> which should be used in such cases.</p>
</div>
<div class="paragraph">
<p>How it might look like in your code is explained by the below example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="asciidoc language-asciidoc">object ExampleObj

def takeAnObject(obj: ExampleObj.type) = {}

takeAnObject(ExampleObj)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="type-variance-in-scala"><a class="anchor" href="#type-variance-in-scala"></a>Type Variance in Scala</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Scala container types are <strong>NOT variant at all by default</strong>!</p>
</div>
<div class="paragraph">
<p>This means that for a container <code>List[Fruit]</code> you cannot insert Apples into it,
even if an <code>class Apple extends Fruit</code>.</p>
</div>
<div class="paragraph">
<p>Variance in Scala is defined by using <code>+</code> and <code>-</code> signs in front of type parameters.</p>
</div>
<div class="paragraph">
<p><a href="http://www.slideshare.net/dgalichet/demystifying-scala-type-system">http://www.slideshare.net/dgalichet/demystifying-scala-type-system</a></p>
</div>
<div class="paragraph">
<p>&lt;table&gt;
    &lt;thead&gt;
    &lt;tr&gt;
        &lt;th&gt;Name&lt;/th&gt;
        &lt;th&gt;Description&lt;/th&gt;
        &lt;th&gt;Scala Syntax&lt;/th&gt;
    &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
    &lt;tr&gt;
        &lt;td class="bold"&gt;Invariant&lt;/td&gt;
        &lt;td&gt;
            &lt;code&gt;C[T']&lt;/code&gt; and &lt;code&gt;C[T]&lt;/code&gt; are &lt;strong&gt;not&lt;/strong&gt; related
        &lt;/td&gt;
        &lt;td&gt;
            &lt;code&gt;C[T]&lt;/code&gt;
        &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td class="bold"&gt;Covariant&lt;/td&gt;
        &lt;td&gt;
            &lt;code&gt;C[T']&lt;/code&gt; is a subclass of &lt;code&gt;C[T]&lt;/code&gt;
        &lt;/td&gt;
        &lt;td&gt;
            &lt;code&gt;C[+T]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;
            &lt;strong&gt;Contravariant&lt;/strong&gt;
        &lt;/td&gt;
        &lt;td&gt;
            &lt;code&gt;C[T]&lt;/code&gt; is a subclass of &lt;code&gt;C[T']&lt;/code&gt;
        &lt;/td&gt;
        &lt;td&gt;
            &lt;code&gt;C[-T]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;</p>
</div>
<div class="paragraph">
<p>There are (at least) two nice and very intuitive examples of this in Scala. One being "any collection", where we&#8217;ll use a <code>List[A]
` as our example, and functions. A `List</code> is defined as <code>List[+A]</code> in Scala, so the below code is valid:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="asciidoc language-asciidoc">class Human
class Coder extends Human

</code></pre>
</div>
</div>
<div class="paragraph">
<p>TODO</p>
</div>
<div class="sect2">
<h3 id="traits-as-in-interfaces-with-implementation"><a class="anchor" href="#traits-as-in-interfaces-with-implementation"></a>Traits, as in "interfaces with implementation"</h3>
<div class="paragraph">
<p>First, let&#8217;s take a look as the simplest thing possible about traits:
how we can basically treat a type with multiple traits mixed in, as if it is implementing these "interfaces with implementation",
as you might be tempted to call them if comming from Java-land:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">class</span> <span class="tok-nc">Base</span> <span class="tok-o">{</span> <span class="tok-k">def</span> <span class="tok-n">b</span> <span class="tok-k">=</span> <span class="tok-s">&quot;&quot;</span> <span class="tok-o">}</span>
<span class="tok-k">trait</span> <span class="tok-nc">Cool</span> <span class="tok-o">{</span> <span class="tok-k">def</span> <span class="tok-n">c</span> <span class="tok-k">=</span> <span class="tok-s">&quot;&quot;</span> <span class="tok-o">}</span>
<span class="tok-k">trait</span> <span class="tok-nc">Awesome</span> <span class="tok-o">{</span> <span class="tok-k">def</span> <span class="tok-n">a</span> <span class="tok-o">=</span><span class="tok-s">&quot;&quot;</span> <span class="tok-o">}</span>

<span class="tok-k">class</span> <span class="tok-nc">BA</span> <span class="tok-k">extends</span> <span class="tok-nc">Base</span> <span class="tok-k">with</span> <span class="tok-nc">Awesome</span>
<span class="tok-k">class</span> <span class="tok-nc">BC</span> <span class="tok-k">extends</span> <span class="tok-nc">Base</span> <span class="tok-k">with</span> <span class="tok-nc">Cool</span>

<span class="tok-c1">// as you might expect, you can upcast these instances into any of the traits they&#39;ve mixed-in</span>
<span class="tok-k">val</span> <span class="tok-n">ba</span><span class="tok-k">:</span> <span class="tok-kt">BA</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-nc">BA</span>
<span class="tok-k">val</span> <span class="tok-n">bc</span><span class="tok-k">:</span> <span class="tok-kt">Base</span> <span class="tok-kt">with</span> <span class="tok-kt">Cool</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-nc">BC</span>

<span class="tok-k">val</span> <span class="tok-n">b1</span><span class="tok-k">:</span> <span class="tok-kt">Base</span> <span class="tok-o">=</span> <span class="tok-n">ba</span>
<span class="tok-k">val</span> <span class="tok-n">b2</span><span class="tok-k">:</span> <span class="tok-kt">Base</span> <span class="tok-o">=</span> <span class="tok-n">bc</span>

<span class="tok-n">ba</span><span class="tok-o">.</span><span class="tok-n">a</span>
<span class="tok-n">bc</span><span class="tok-o">.</span><span class="tok-n">c</span>
<span class="tok-n">b1</span><span class="tok-o">.</span><span class="tok-n">b</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>So far this should have been relatively well known to you. Now let&#8217;s to into the world of the "diamond problem",
which people who know C++ might have been expecting. Basically "The Diamond Problem" is a situation during multiple inheritance
where we&#8217;re not sure to what we want to refer to. The below image ilustrates the problem, if you would think of traits as if they were
directly multiple inheritance:</p>
</div>
</div>
<div class="sect2">
<h3 id="type-linearization-vs-the-diamond-problem"><a class="anchor" href="#type-linearization-vs-the-diamond-problem"></a>Type Linearization vs. The Diamond Problem</h3>
<div class="paragraph">
<p>![diamond-inheritance-problem](<a href="http://upload.wikimedia.org/wikipedia/commons/thumb/8/8e/Diamond_inheritance.svg/220px-Diamond_inheritance.svg.png">http://upload.wikimedia.org/wikipedia/commons/thumb/8/8e/Diamond_inheritance.svg/220px-Diamond_inheritance.svg.png</a>)</p>
</div>
<div class="paragraph">
<p>For the "diamond problem" to appear, it&#8217;s enough if we have one overriding implementation in <code>B</code> or/and <code>C</code>. This introduces an ambiguity when calling the common method in <code>D</code>, did we inherit the version of the method from <code>C</code> or from <code>B</code>? In Scala&#8217;s case the case with only one overriding method is very simple - the override wins. But let&#8217;s work through the more complex case:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>class <code>A</code> defines a method <code>common</code> returning <code>a</code>,</p>
</li>
<li>
<p>trait <code>B</code> DOES override <code>common</code> to return <code>b</code>,</p>
</li>
<li>
<p>trait <code>C</code> DOES override <code>common</code> to return <code>c</code>,</p>
</li>
<li>
<p>class <code>D</code> extends both <code>B</code> and <code>C</code>,</p>
</li>
<li>
<p>which version of the <code>common</code> method does class <code>D</code> inherit? The overriden impementation from <code>C</code>, or theone from <code>B</code>?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This amgiguity is a pain point of every multiple-inheritance-like mechanism. Scala solves this problem by so called <strong>Type Linearization</strong>.
In other words, given a diamond class hierarchy, we are <strong>always</strong> (and <strong>deterministically</strong>) able to determine what will be called when inside D we call <code>common</code>.
Let&#8217;s put this into code and then talk about linearization:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">trait</span> <span class="tok-nc">A</span> <span class="tok-o">{</span> <span class="tok-k">def</span> <span class="tok-n">common</span> <span class="tok-k">=</span> <span class="tok-s">&quot;A&quot;</span> <span class="tok-o">}</span>

<span class="tok-k">trait</span> <span class="tok-nc">B</span> <span class="tok-k">extends</span> <span class="tok-n">A</span> <span class="tok-o">{</span> <span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">common</span> <span class="tok-k">=</span> <span class="tok-s">&quot;B&quot;</span> <span class="tok-o">}</span>
<span class="tok-k">trait</span> <span class="tok-nc">C</span> <span class="tok-k">extends</span> <span class="tok-n">A</span> <span class="tok-o">{</span> <span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">common</span> <span class="tok-k">=</span> <span class="tok-s">&quot;C&quot;</span> <span class="tok-o">}</span>

<span class="tok-k">class</span> <span class="tok-nc">D1</span> <span class="tok-k">extends</span> <span class="tok-n">B</span> <span class="tok-k">with</span> <span class="tok-n">C</span>
<span class="tok-k">class</span> <span class="tok-nc">D2</span> <span class="tok-k">extends</span> <span class="tok-n">C</span> <span class="tok-k">with</span> <span class="tok-n">B</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>The results will be as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-o">(</span><span class="tok-k">new</span> <span class="tok-n">D1</span><span class="tok-o">).</span><span class="tok-n">common</span> <span class="tok-o">==</span> <span class="tok-s">&quot;C&quot;</span>

<span class="tok-o">(</span><span class="tok-k">new</span> <span class="tok-n">D2</span><span class="tok-o">).</span><span class="tok-n">common</span> <span class="tok-o">==</span> <span class="tok-s">&quot;B&quot;</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>The reason for this is that Scala applied the type linearization for us here. The algorithm goes like this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>start building a list of types, the first element is the type we&#8217;re linearizing right now,</p>
</li>
<li>
<p>expand each supertype recursively and put all their types into this list (it should be flat, not nested),</p>
</li>
<li>
<p>remove duplicates from the resulting list, by scanning it from the left, and removing a type that you&#8217;ve already "seen"</p>
</li>
<li>
<p>done.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s apply this algorithm on our diamond example by hand, to verify why <code>D1 extends B with C</code> (and <code>D2 extends C with B</code>) yielded the results they did:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-c1">// start with D1:</span>
<span class="tok-n">B</span> <span class="tok-k">with</span> <span class="tok-n">C</span> <span class="tok-k">with</span> <span class="tok-o">&lt;</span><span class="tok-n">D1</span><span class="tok-o">&gt;</span>

<span class="tok-c1">// expand all the types until you rach Any for all of them:</span>
<span class="tok-o">(</span><span class="tok-nc">Any</span> <span class="tok-k">with</span> <span class="tok-nc">AnyRef</span> <span class="tok-k">with</span> <span class="tok-n">A</span> <span class="tok-k">with</span> <span class="tok-n">B</span><span class="tok-o">)</span> <span class="tok-k">with</span> <span class="tok-o">(</span><span class="tok-nc">Any</span> <span class="tok-k">with</span> <span class="tok-nc">AnyRef</span> <span class="tok-k">with</span> <span class="tok-n">A</span> <span class="tok-k">with</span> <span class="tok-n">C</span><span class="tok-o">)</span> <span class="tok-k">with</span> <span class="tok-o">&lt;</span><span class="tok-n">D1</span><span class="tok-o">&gt;</span>

<span class="tok-c1">// remove duplicates by removing &quot;already seen&quot; types, when moving left-to-right:</span>
<span class="tok-o">(</span><span class="tok-nc">Any</span> <span class="tok-k">with</span> <span class="tok-nc">AnyRef</span> <span class="tok-k">with</span> <span class="tok-n">A</span> <span class="tok-k">with</span> <span class="tok-n">B</span><span class="tok-o">)</span> <span class="tok-k">with</span> <span class="tok-o">(</span>                            <span class="tok-n">C</span><span class="tok-o">)</span> <span class="tok-k">with</span> <span class="tok-o">&lt;</span><span class="tok-n">D1</span><span class="tok-o">&gt;</span>

<span class="tok-c1">// write the resulting type nicely:</span>
<span class="tok-nc">Any</span> <span class="tok-k">with</span> <span class="tok-nc">AnyRef</span> <span class="tok-k">with</span> <span class="tok-n">A</span> <span class="tok-k">with</span> <span class="tok-n">B</span> <span class="tok-k">with</span> <span class="tok-n">C</span> <span class="tok-k">with</span> <span class="tok-o">&lt;</span><span class="tok-n">D1</span><span class="tok-o">&gt;</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>So when calling the <code>common</code> method, it&#8217;s now very simple to decide which version we want to call: we simply look at the linearized type,
and try to resolve the method by going from the right in the resulting linearized type. In the case of <code>D1</code>, the "rightmost" trait providing an implementation of <code>common</code> is <code>C</code>, so it&#8217;s overriding the implementation provided by <code>B</code>. The result of calling <code>common</code> inside <code>D1</code> would be <code>"c"</code>.</p>
</div>
<div class="paragraph">
<p>You can wrap your head around this method by trying it out on the <code>D2</code> class - it should linearize with <code>B</code> after <code>C</code>, thus yielding a <code>"b"</code> if you&#8217;d run the code.
Also it&#8217;s rather easy to resolve the simpler cases of linearization by just thinking "rightmost wins", but this is quite an simplification, which while helpful, does not give the full picture about the algorithm.</p>
</div>
<div class="paragraph">
<p>It is worth mentioning that using this technique we also know <strong>"who is my <code>super</code>?"</strong>. It&#8217;s as easy as "looking left" in the linearized type, from wherever class you want to check who your superclass is. So for example in our case (<code>D1</code>), the superclass of <code>C</code> is <code>B</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="refined-types-refinements"><a class="anchor" href="#refined-types-refinements"></a>Refined Types (refinements)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Refinements are very easy to explain as "subclassing without naming the subclass". So in source code it would look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">class</span> <span class="tok-nc">Entity</span>

<span class="tok-k">trait</span> <span class="tok-nc">Persister</span> <span class="tok-o">{</span>
  <span class="tok-k">def</span> <span class="tok-n">doPersist</span><span class="tok-o">(</span><span class="tok-n">e</span><span class="tok-k">:</span> <span class="tok-kt">Entity</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-o">{</span>
    <span class="tok-n">e</span><span class="tok-o">.</span><span class="tok-n">persistForReal</span><span class="tok-o">()</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span>

<span class="tok-c1">// our refined instance (and type):</span>
<span class="tok-k">val</span> <span class="tok-n">refinedMockPersister</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">Persister</span> <span class="tok-o">{</span>
  <span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">doPersist</span><span class="tok-o">(</span><span class="tok-n">e</span><span class="tok-k">:</span> <span class="tok-kt">Entity</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-o">()</span>
<span class="tok-o">}</span>
</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="type-alias"><a class="anchor" href="#type-alias"></a>Type Alias</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It&#8217;s not really another kind of type, but a trick we can use to make our code more readable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">type</span> <span class="tok-kt">User</span> <span class="tok-o">=</span> <span class="tok-nc">String</span>
<span class="tok-k">type</span> <span class="tok-kt">Age</span> <span class="tok-o">=</span> <span class="tok-nc">Int</span>

<span class="tok-k">val</span> <span class="tok-n">data</span><span class="tok-k">:</span>  <span class="tok-kt">Map</span><span class="tok-o">[</span><span class="tok-kt">User</span>, <span class="tok-kt">Age</span><span class="tok-o">]</span> <span class="tok-k">=</span>  <span class="tok-nc">Map</span><span class="tok-o">.</span><span class="tok-n">empty</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using this trick the Map definition now suddenly "makes sense!". If we&#8217;d just use a  <code>String =&gt; Int</code> map,
we&#8217;d make the code less readable. Here we can keep using our primitives (maybe we need this for performance etc),
but <strong>name them</strong> so it makes sense for the future reader of this class.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="abstract-type-member"><a class="anchor" href="#abstract-type-member"></a>Abstract Type Member</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s now go deeper into the use cases of Type Aliases, which we call Abstract Type Members.</p>
</div>
<div class="paragraph">
<p>With Abstract Type Members we say "I expect someone to tell me about some type - I&#8217;ll refer to it by the name MyType".
It&#8217;s most basic function is allowing us to define generic classes (templates), but instead of using the <code>class Clazz[A, B]</code> syntax, we name them inside the class, like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">trait</span> <span class="tok-nc">SimplestContainer</span> <span class="tok-o">{</span>
  <span class="tok-k">type</span> <span class="tok-kt">A</span>      <span class="tok-c1">// Abstract Type Member</span>

  <span class="tok-k">def</span> <span class="tok-n">value</span><span class="tok-k">:</span> <span class="tok-kt">A</span>
<span class="tok-o">}</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>Which for Java folks may seem very similar to the <code>Container&lt;A&gt;</code> syntax at first, but it&#8217;s a bit more powerful as we&#8217;ll see in the section about <strong>Path-dependent Types</strong>, as well as in the below example.</p>
</div>
<div class="paragraph">
<p>todo; Then, this is how we would implement this trait:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">object</span> <span class="tok-nc">IntContainer</span> <span class="tok-k">extends</span> <span class="tok-nc">SimplestContainer</span> <span class="tok-o">{</span>
  <span class="tok-k">type</span> <span class="tok-kt">A</span> <span class="tok-o">=</span> <span class="tok-nc">Int</span>

  <span class="tok-k">def</span> <span class="tok-n">value</span> <span class="tok-k">=</span> <span class="tok-mi">42</span>
<span class="tok-o">}</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>So we "provide the type" using a Type Alias on line 2 here, and now we can implement the value method, as it&#8217;s type is known.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="self-recursive-type"><a class="anchor" href="#self-recursive-type"></a>Self-Recursive Type</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This we brought up with &lt;a href="http://andrzejgrzesik.info"&gt;Andrzej Grzesik&lt;/a&gt;, while discussing my blog post series about various Type Systems (my favourite topic :-)). Andrzej followed up &lt;a href="http://andrzejgrzesik.info/2013/09/29/container-types/"&gt;on his blog, by explaining how the self-recursive generic type trick works in Java&#8217;s Enum class&lt;/a&gt;. Another nice blog post about this type-trick, is &lt;a href="http://blog.jooq.org/2013/06/28/the-dangers-of-correlating-subtype-polymorphism-with-generic-polymorphism/"&gt;The dangers of correlating subtype polymorphism with generic polymorphism&lt;/a&gt;, where lukaseder points out why/where this pattern may cause you trouble.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">class</span> <span class="tok-nc">Apple</span>
</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="type-class"><a class="anchor" href="#type-class"></a>Type Class</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">trait</span> <span class="tok-nc">Writes</span><span class="tok-o">[</span><span class="tok-kt">In</span>, <span class="tok-kt">Out</span><span class="tok-o">]</span> <span class="tok-o">{</span>
  <span class="tok-k">def</span> <span class="tok-n">write</span><span class="tok-o">(</span><span class="tok-n">it</span><span class="tok-k">:</span> <span class="tok-kt">In</span><span class="tok-o">)</span><span class="tok-k">:</span> <span class="tok-kt">Out</span>
<span class="tok-o">}</span>

<span class="tok-k">implicit</span> <span class="tok-k">val</span> <span class="tok-n">jsonWriter</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">Writes</span><span class="tok-o">[</span><span class="tok-kt">Person</span>, <span class="tok-kt">Json</span><span class="tok-o">]</span> <span class="tok-o">{</span>
  <span class="tok-k">def</span> <span class="tok-n">writes</span><span class="tok-o">(</span><span class="tok-n">p</span><span class="tok-k">:</span> <span class="tok-kt">Person</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-nc">Json</span><span class="tok-o">.</span><span class="tok-n">toJson</span><span class="tok-o">(</span><span class="tok-n">p</span><span class="tok-o">)</span>
<span class="tok-o">}</span>

<span class="tok-k">implicit</span> <span class="tok-k">class</span> <span class="tok-nc">Writeable</span><span class="tok-o">[</span><span class="tok-kt">A</span><span class="tok-o">]</span> <span class="tok-o">{</span>
  <span class="tok-k">def</span> <span class="tok-n">write</span><span class="tok-o">(</span><span class="tok-k">implicit</span> <span class="tok-n">writes</span><span class="tok-k">:</span> <span class="tok-kt">Writes</span><span class="tok-o">[</span><span class="tok-kt">A</span><span class="tok-o">])</span>
<span class="tok-o">}</span>
</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="type-constructor"><a class="anchor" href="#type-constructor"></a>Type Constructor</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Also known as <strong>Higher Kinds</strong>, Type Constructors act pretty much like functions, but on the type level.
That is, if in normal programming you can have a function that takes a value <code>a</code> and returns a value <code>b</code> based on the previous one, then in type-level programming you&#8217;d think of a <code>List[A]</code> being a type constructor, that is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>List[A]</code> takes a type parameter (<code>A</code>),</p>
</li>
<li>
<p>by itself it&#8217;s not a valid type, you need to fill in the A somehow - construct the type,</p>
</li>
<li>
<p>by fillinf it in with <code>Int</code> you&#8217;d get <code>List[Int]</code> which is a concrete type.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Using this example, you can see how similar it is to normal constructors - with the only difference that here we work on types, and not instances of objects. It&#8217;s worth reminding here that in Scala it is not valid to say something is of type <code>List</code>, <strong>unlike in Java</strong> where javac would put the <code>List&lt;Object&gt;</code> for you. Scala is more strict here, and won&#8217;t allow us to use <code>just a List</code> in the place of a type, as it&#8217;s expecting a real type - not a type constructor.</p>
</div>
<div class="paragraph">
<p>Related to this subject is that with <strong>Scala 2.11.x</strong> we&#8217;re getting a new power user command in the REPL - the <code>:kind</code> command. It allows you to check if a type is higher kind or not. Let&#8217;s check it our on a simple type constructor, such as <code>List[+A]</code> first:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-c1">// Welcome to Scala version 2.11.0-M5 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0-ea).</span>
<span class="tok-c1">// Type in expressions to have them evaluated.</span>

<span class="tok-k">:</span><span class="tok-kt">kind</span> <span class="tok-kt">List</span>
<span class="tok-c1">// scala.collection.immutable.List&#39;s kind is F[+A]</span>

<span class="tok-k">:</span><span class="tok-kt">kind</span> <span class="tok-kt">-v</span> <span class="tok-kt">List</span>
<span class="tok-c1">// scala.collection.immutable.List&#39;s kind is F[+A]</span>
<span class="tok-c1">// * -(+)-&gt; *</span>
<span class="tok-c1">// This is a type constructor: a 1st-order-kinded type.</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here we see that scalac is able to tell us that <code>List</code>, in fact, is a type constructor (it&#8217;s way more talkative when used with the <code>-v`erbose option). Let's investigate the syntax right above this information: `* -&gt; *</code>. This syntax is widely used to represent kinds, and actually I found it quite Haskell inspired - as this is the syntax Haskell uses to print types of functions. The most intuitive way to read it out loud would be "takes one type, returns another type". You might have noticed that we&#8217;ve omitted something from Scala&#8217;s exact output, the plus sign from the relation (as in:<code>* -(+)-&gt; *</code>), this means variance bounds and you can read up in detail about variance in section (TODO LINK TO VARIANCE).</p>
</div>
<div class="paragraph">
<p>As already mentioned, <code>List[A]</code> (or <code>Option[A]</code>, or <code>Set[A]</code>&#8230; or anything that has one type parameter) is the simplest case of a type constructor - these take one parameter. Let&#8217;s take a look how type constructors with multiple type parameters are represented by investigating Scala&#8217;s <code>Either[+A, +B]</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">:</span><span class="tok-kt">kind</span> <span class="tok-kt">-v</span> <span class="tok-kt">Either</span>
<span class="tok-c1">// scala.util.Either&#39;s kind is F[+A1,+A2]</span>
<span class="tok-c1">// * -(+)-&gt; * -(+)-&gt; *</span>
<span class="tok-c1">// This is a type constructor: a 1st-order-kinded type.</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>So here we have a type that needs two type parameters in order to be able to construct a real type. This could be understood as "A type constructor that takes a Type, and returns a type constructor that takes another type, and returns the real type". If we think back to functions and try to apply the same thinking we could say that an addition (<code>def +(a: Int, b: Int)</code>) is basically a function taking <code>a</code> which returns a function taking <code>b</code>, and just then we apply the computation. For functions this can be expresses easily by using the multiple parameter lists syntax (<code>def +(a: Int)(b: Int)</code>). It&#8217;s a very useful way of thinking about applying functions (and types), as it allows us to partially apply a function, and then pass it somewhere else - where someone will pass in the missing parameter. Now we just need to bring this thinking into the type level! Which means that we might partially construct a type - by saying that in <code>Either[A, B]</code> we want to bind <code>A</code> to <code>Int</code>, but we have no idea about <code>B</code> yet - someone else will know.
This idea opens up the way to (Type Lambdas)[#type-lambda] which have a full chapter about them.</p>
</div>
<div class="paragraph">
<p>And a small bonus for the curious, the kind of a concrete type is simply A (no place for any <code>-&gt;</code> in there!).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">:</span><span class="tok-kt">kind</span> <span class="tok-kt">String</span>
<span class="tok-c1">// java.lang.String&#39;s kind is A</span>
</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="self-type-annotation"><a class="anchor" href="#self-type-annotation"></a>Self Type Annotation</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Self Types</strong> are used in order to "require" that, if another class uses this trait,
it should also provide implementation of whatever it is that you&#8217;re requireing.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s look at an example where a service requires some Module which provides other services.
We can state this using the following Self Type Annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">trait</span> <span class="tok-nc">Module</span> <span class="tok-o">{</span>
  <span class="tok-k">lazy</span> <span class="tok-k">val</span> <span class="tok-n">serviceInModule</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">ServiceInModule</span>
<span class="tok-o">}</span>

<span class="tok-k">trait</span> <span class="tok-nc">Service</span> <span class="tok-o">{</span>
  <span class="tok-k">this:</span> <span class="tok-kt">Module</span> <span class="tok-o">=&gt;</span>

  <span class="tok-k">def</span> <span class="tok-n">doTheThings</span><span class="tok-o">()</span> <span class="tok-k">=</span> <span class="tok-n">serviceInModule</span><span class="tok-o">.</span><span class="tok-n">doTheThings</span><span class="tok-o">()</span>
<span class="tok-o">}</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>The second line can be read as "I&#8217;m a Module". It might seem yield the exactly same But how does this differ from extending <code>Module</code> right away?</p>
</div>
<div class="paragraph">
<p>which means that someone will have to give us this Module at instanciation time:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">trait</span> <span class="tok-nc">TestingModule</span> <span class="tok-k">extends</span> <span class="tok-nc">Module</span> <span class="tok-o">{</span> <span class="tok-cm">/*...*/</span> <span class="tok-o">}</span>

<span class="tok-k">new</span> <span class="tok-nc">Service</span> <span class="tok-k">with</span> <span class="tok-nc">TestingModule</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you were to try to instanciate it without mixing in the required trait it would fail like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">new</span> <span class="tok-nc">Service</span>

<span class="tok-c1">// class Service cannot be instantiated because it does not conform to its self-type Service with Module</span>
<span class="tok-c1">//              new Service</span>
<span class="tok-c1">//              ^</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should also keep in mind, that it&#8217;s OK, to specify more than one trait when using the self-type syntax.
And while we&#8217;re at it, let&#8217;s discuss why it is called self-type (except for the "yeah, it makes sense" factor). Turns out a popular style (and possibility) to write it looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">class</span> <span class="tok-nc">Service</span> <span class="tok-o">{</span>
  <span class="tok-n">self</span><span class="tok-k">:</span> <span class="tok-kt">MongoModule</span> <span class="tok-kt">with</span> <span class="tok-kt">APIModule</span> <span class="tok-o">=&gt;</span>

  <span class="tok-k">def</span> <span class="tok-n">delegated</span> <span class="tok-k">=</span> <span class="tok-n">self</span><span class="tok-o">.</span><span class="tok-n">doTheThings</span><span class="tok-o">()</span>
<span class="tok-o">}</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>In fact, you can use any identifier (not just <code>this</code> or <code>self</code>) and then refer to it from your class.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="phantom-type"><a class="anchor" href="#phantom-type"></a>Phantom Type</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now we&#8217;re starting to get into the more interesting Types! :-)</p>
</div>
<div class="paragraph">
<p>Phantom Types are a mean of staticly validating your sources, during compile time.
It&#8217;s used in many libraries, to prevent you from using some API, with an object in "not the right state".</p>
</div>
<div class="paragraph">
<p>To set the stage for our Phantom Type usage let&#8217;s first define a <code>ServiceHandle</code> class,
and <code>trait`s to represent the state it is in. We want to prevent users of our API from calling `stop()</code> on an already
<code>Stopped</code> instance, as well as prevent them from calling <code>start()</code> on an already <code>Running</code> instance.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-c1">// the traits are expected to be only used with our ServiceHandle,</span>
<span class="tok-c1">// which we nicely express using Self Type Annotations.</span>
<span class="tok-k">trait</span> <span class="tok-nc">Stopped</span> <span class="tok-o">{</span> <span class="tok-k">this:</span> <span class="tok-kt">ServiceHandle</span> <span class="tok-o">=&gt;</span> <span class="tok-o">}</span>
<span class="tok-k">trait</span> <span class="tok-nc">Running</span> <span class="tok-o">{</span> <span class="tok-k">this:</span> <span class="tok-kt">ServiceHandle</span> <span class="tok-o">=&gt;</span> <span class="tok-o">}</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now that we have our Types prepared, let&#8217;s look at how the implementation will look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">class</span> <span class="tok-nc">ServiceHandle</span> <span class="tok-k">private</span> <span class="tok-o">(</span><span class="tok-n">id</span><span class="tok-k">:</span> <span class="tok-kt">Id</span><span class="tok-o">)</span>
<span class="tok-k">object</span> <span class="tok-nc">ServiceHandle</span> <span class="tok-o">{</span>
  <span class="tok-k">def</span> <span class="tok-n">create</span><span class="tok-o">(</span><span class="tok-n">id</span><span class="tok-k">:</span> <span class="tok-kt">Id</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">ServiceHandle</span><span class="tok-o">(</span><span class="tok-n">id</span><span class="tok-o">)</span> <span class="tok-k">with</span> <span class="tok-nc">Stopped</span>
<span class="tok-o">}</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, during instanciation of the class, we mix in the <code>Stopped</code> trait right away.
We&#8217;ve used this trick before in this blog post (series), but now it&#8217;s finally time to explain it in detail.</p>
</div>
<div class="paragraph">
<p>Turns out that the type of this newly created ServiceHandle is not only <code>ServiceHandle</code> but&#8230;
<code>ServiceHandle with Stopped</code>. It may seem underwhelming at first that "that&#8217;s it",
but let&#8217;s move on to the <code>start</code> and <code>stop</code> commands to see why this us so nice interesting.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">def</span> <span class="tok-n">start</span><span class="tok-o">(</span><span class="tok-n">s</span><span class="tok-k">:</span> <span class="tok-kt">ServiceHandle</span> <span class="tok-kt">with</span> <span class="tok-kt">Stopped</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-o">{</span>
  <span class="tok-n">s</span><span class="tok-o">.</span><span class="tok-n">start</span><span class="tok-o">()</span>
  <span class="tok-k">new</span> <span class="tok-nc">ServiceHandle</span><span class="tok-o">(</span><span class="tok-n">s</span><span class="tok-o">.</span><span class="tok-n">id</span><span class="tok-o">)</span> <span class="tok-k">with</span> <span class="tok-nc">Running</span>
<span class="tok-o">}</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>And we can do the same for stopping a Service. Other useful methods would be,
<code>Id =&gt; Either[ServiceHandle with Stopped, ServiceHandle with Running]</code> which&#8217;s implementation you can easily imagine.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">def</span> <span class="tok-n">stop</span><span class="tok-o">(</span><span class="tok-n">s</span><span class="tok-k">:</span> <span class="tok-kt">ServiceHandle</span> <span class="tok-kt">with</span> <span class="tok-kt">Running</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-o">{</span>
  <span class="tok-n">s</span><span class="tok-o">.</span><span class="tok-n">stop</span><span class="tok-o">()</span>
  <span class="tok-k">new</span> <span class="tok-nc">ServiceHandle</span><span class="tok-o">(</span><span class="tok-n">s</span><span class="tok-o">.</span><span class="tok-n">id</span><span class="tok-o">)</span> <span class="tok-k">with</span> <span class="tok-nc">Stopped</span>
<span class="tok-o">}</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>TODO MAKE BETTER EXAMPLES</p>
</div>
<div class="paragraph">
<p>Fun Java Fact: A similar end-result - failing during compilation - can also be done in Java, using annotation processors and Annotated types (you should check out Adam Warski&#8217;s example on this if you&#8217;re curious).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="structural-type"><a class="anchor" href="#structural-type"></a>Structural Type</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Strucural Types are often compared to "<strong>type-safe duck typing</strong>", which is quite a good comparation if you&#8217;d want to get some intuition for it.</p>
</div>
<div class="paragraph">
<p>So far we&#8217;ve only been thinking about types in terms of "<strong>does it implement interface X?</strong>". With <strong>structural types</strong> we can go a step further and start reasoning
about the structure of a given object (hence the name). When using structure to check if something matches such type we have to change our question to: "<strong>does it have a method with this signature?</strong>".</p>
</div>
<div class="paragraph">
<p>Let&#8217;s look at a very popular use-case in action, to see why it is so powerful. Imagine that you have many classes of things that can be <strong>closed</strong>. In Java-land one would usualy implement the <code>java.io.Closeable</code> interface in order to make it possible to write some common <code>Closeables</code> utility class (in fact, <strong>Google Guava</strong> provides such an utility class). Now imagine that someone also implemented a <code>MyOwnCloseable</code> class but didn&#8217;t extend <code>java.io.Closeable</code>. Your <code>Closeables</code> library would be stuck - as due to the static typing, you would not be able to pass instances of <code>MyOwnCloseable</code> into it. Let&#8217;s solve this problem via using Structural Typing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">type</span> <span class="tok-kt">JavaCloseable</span> <span class="tok-o">=</span> <span class="tok-n">java</span><span class="tok-o">.</span><span class="tok-n">io</span><span class="tok-o">.</span><span class="tok-nc">Closeable</span>
<span class="tok-c1">// reminder, it&#39;s body is: { def close(): Unit }</span>

<span class="tok-k">class</span> <span class="tok-nc">MyOwnCloseable</span> <span class="tok-o">{</span>
  <span class="tok-k">def</span> <span class="tok-n">close</span><span class="tok-o">()</span><span class="tok-k">:</span> <span class="tok-kt">Unit</span> <span class="tok-o">=</span> <span class="tok-o">()</span>
<span class="tok-o">}</span>


<span class="tok-c1">// method taking a Structural Type</span>
<span class="tok-k">def</span> <span class="tok-n">closeQuietly</span><span class="tok-o">(</span><span class="tok-n">closeable</span><span class="tok-k">:</span> <span class="tok-o">{</span> <span class="tok-kt">def</span> <span class="tok-kt">close</span><span class="tok-o">()</span><span class="tok-kt">:</span> <span class="tok-kt">Unit</span> <span class="tok-o">})</span> <span class="tok-k">=</span>
  <span class="tok-k">try</span> <span class="tok-o">{</span>
    <span class="tok-n">closeable</span><span class="tok-o">.</span><span class="tok-n">close</span><span class="tok-o">()</span>
  <span class="tok-o">}</span> <span class="tok-k">catch</span> <span class="tok-o">{</span>
    <span class="tok-k">case</span> <span class="tok-n">ex</span><span class="tok-k">:</span> <span class="tok-kt">Exception</span> <span class="tok-o">=&gt;</span> <span class="tok-c1">// ignore...</span>
  <span class="tok-o">}</span>


<span class="tok-c1">// takes a java.io.File (implements Closeable):</span>
<span class="tok-n">closeQuietly</span><span class="tok-o">(</span><span class="tok-k">new</span> <span class="tok-nc">StringReader</span><span class="tok-o">(</span><span class="tok-s">&quot;example&quot;</span><span class="tok-o">))</span>

<span class="tok-c1">// takes</span>
<span class="tok-n">closeQuietly</span><span class="tok-o">(</span><span class="tok-k">new</span> <span class="tok-nc">MyOwnCloseable</span><span class="tok-o">)</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>The structural type is defined on the method&#8217;s parameter here. It basically says that the only thing we expect from the type that should be passed in here
is that it should have this method. It could have more methods - so it&#8217;s not an exact match but the minimal set of methods a type has to define in order to be valid for us.</p>
</div>
<div class="paragraph">
<p>Another fact to keep in mind when using <strong>Structural Typing is that it actually has huge (negative) runtime performance implications, as it is actually implemented
using reflection</strong>. We won&#8217;t look into the byte code for this case, but remember that it&#8217;s very easy to investitage the generated bytecode for scala (or java) classes, by using :javap in the Scala REPL, so you can check it out yourself.</p>
</div>
<div class="paragraph">
<p>Before we move over to the next subject, let&#8217;s briefly touch on a small but neat stype tip.
Imagine that your Structural Type is quite big, an example would be - a type representing something that you can open, work on, and then must close.
By using a Type Alias (described in detail in another section) with the Structural Type, we&#8217;re able to separate the type definition from the method, where we want to take in such instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">type</span> <span class="tok-kt">OpenerCloser</span> <span class="tok-o">=</span> <span class="tok-o">{</span>
  <span class="tok-k">def</span> <span class="tok-n">open</span><span class="tok-o">()</span><span class="tok-k">:</span> <span class="tok-kt">Unit</span>
  <span class="tok-k">def</span> <span class="tok-n">close</span><span class="tok-o">()</span><span class="tok-k">:</span> <span class="tok-kt">Unit</span>
<span class="tok-o">}</span>

<span class="tok-k">def</span> <span class="tok-n">on</span><span class="tok-o">(</span><span class="tok-n">it</span><span class="tok-k">:</span> <span class="tok-kt">OpenerCloser</span><span class="tok-o">)(</span><span class="tok-n">fun</span><span class="tok-k">:</span> <span class="tok-kt">OpenerCloser</span> <span class="tok-o">=&gt;</span> <span class="tok-nc">Unit</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-o">{</span>
  <span class="tok-n">it</span><span class="tok-o">.</span><span class="tok-n">open</span><span class="tok-o">()</span>
  <span class="tok-n">fun</span><span class="tok-o">(</span><span class="tok-n">it</span><span class="tok-o">)</span>
  <span class="tok-n">it</span><span class="tok-o">.</span><span class="tok-n">close</span><span class="tok-o">()</span>
<span class="tok-o">}</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>So using this type alias, we&#8217;ve made the <code>def</code> way cleaner - so I&#8217;d highly recommend type aliasing bigger structural types. And one last warning, always check
if you really need to reach for structural typing, and cannot do it in some other way - as it has quite some negative performance impact.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="path-dependent-type"><a class="anchor" href="#path-dependent-type"></a>Path Dependent Type</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This Type allows us to type-check on a Type internal to another class. This may seem weird at first, but is very intuitive once you see it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">class</span> <span class="tok-nc">Outer</span> <span class="tok-o">{</span>
  <span class="tok-k">class</span> <span class="tok-nc">Inner</span>
<span class="tok-o">}</span>

<span class="tok-k">val</span> <span class="tok-n">out1</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">Outer</span>
<span class="tok-k">val</span> <span class="tok-n">out1in</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-n">out1</span><span class="tok-o">.</span><span class="tok-nc">Inner</span> <span class="tok-c1">// concrete instance, created from inside of Outer</span>

<span class="tok-k">val</span> <span class="tok-n">out2</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">Outer</span>
<span class="tok-k">val</span> <span class="tok-n">out2in</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-n">out2</span><span class="tok-o">.</span><span class="tok-nc">Inner</span> <span class="tok-c1">// another instance of Inner, with the enclosing instance out2</span>

<span class="tok-c1">// the path dependent type. The &quot;path&quot; is &quot;inside out1&quot;.</span>
<span class="tok-k">type</span> <span class="tok-kt">PathDep1</span> <span class="tok-o">=</span> <span class="tok-n">out1</span><span class="tok-o">.</span><span class="tok-nc">Inner</span>


<span class="tok-c1">// type checks</span>

<span class="tok-k">val</span> <span class="tok-n">typeChecksOk</span><span class="tok-k">:</span> <span class="tok-kt">PathDep1</span> <span class="tok-o">=</span> <span class="tok-n">out1in</span>
<span class="tok-c1">// OK</span>

<span class="tok-k">val</span> <span class="tok-n">typeCheckFails</span><span class="tok-k">:</span> <span class="tok-kt">PathDep1</span> <span class="tok-o">=</span> <span class="tok-n">out2in</span>
<span class="tok-c1">// &lt;console&gt;:27: error: type mismatch;</span>
<span class="tok-c1">// found   : out2.Inner</span>
<span class="tok-c1">// required: PathDep1</span>
<span class="tok-c1">//    (which expands to)  out1.Inner</span>
<span class="tok-c1">//       val typeCheckFails: PathDep1 = out2in</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>The ey to understand here isthat "each class Outer, has it&#8217;s own Inner class", so it&#8217;s a different Type - dependent on which path we use to get there.</p>
</div>
<div class="paragraph">
<p>Using this kind of typing is useful, we&#8217;re able to enforce getting the type from inside of a concrete parameter. An example of a signature using this typing would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">class</span> <span class="tok-nc">Parent</span> <span class="tok-o">{</span>
  <span class="tok-k">class</span> <span class="tok-nc">Child</span>
<span class="tok-o">}</span>

<span class="tok-k">class</span> <span class="tok-nc">ChildrenContainer</span><span class="tok-o">(</span><span class="tok-n">p</span><span class="tok-k">:</span> <span class="tok-kt">Parent</span><span class="tok-o">)</span> <span class="tok-o">{</span>
  <span class="tok-k">type</span> <span class="tok-kt">ChildOfThisParent</span> <span class="tok-o">=</span> <span class="tok-n">p</span><span class="tok-o">.</span><span class="tok-nc">Child</span>

  <span class="tok-k">def</span> <span class="tok-n">add</span><span class="tok-o">(</span><span class="tok-n">c</span><span class="tok-k">:</span> <span class="tok-kt">ChildOfThisParent</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-o">???</span>
<span class="tok-o">}</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using the path dependent type we have now encoded in the type system, the logic,
that this container should only contain children of this parent - and not "any parent".</p>
</div>
<div class="paragraph">
<p>We&#8217;ll see how to require the "child of any parent" Type using Type Projectsions in the next section.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="type-projection"><a class="anchor" href="#type-projection"></a>Type Projection</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Type Projections are similar to Path Dependent Types, in the way that they allow you to refer to a type of an inner class. In terms of syntax, you path your way into the structure of inner classes, splitting them with a <code>#</code> sign (hash sign, pound sign). Let&#8217;s start out by showing the first and main difference between these path dependent types (the "." syntax) vs. type projections (the "#" syntax):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-c1">// our example class structure</span>
<span class="tok-k">class</span> <span class="tok-nc">Outer</span> <span class="tok-o">{</span>
  <span class="tok-k">class</span> <span class="tok-nc">Inner</span>
<span class="tok-o">}</span>

<span class="tok-c1">// Type Projection (and alias) refering to Inner</span>
<span class="tok-k">type</span> <span class="tok-kt">OuterInnerProjection</span> <span class="tok-o">=</span> <span class="tok-nc">Outer</span><span class="tok-k">#</span><span class="tok-nc">Inner</span>

<span class="tok-k">val</span> <span class="tok-n">out1</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">Outer</span>
<span class="tok-k">val</span> <span class="tok-n">out1in</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-n">out1</span><span class="tok-o">.</span><span class="tok-nc">Inner</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>Another nice intuition about path dependent vs. projections is that Type Projections can be used for "type level programming" ;-)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="existential-types"><a class="anchor" href="#existential-types"></a>Existential Types</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Existential Types are something that deeply relates to Type Erasure, which JVM languages "have to live with".</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">val</span> <span class="tok-n">thingy</span><span class="tok-k">:</span> <span class="tok-kt">Any</span> <span class="tok-o">=</span> <span class="tok-o">???</span>

<span class="tok-n">thingy</span> <span class="tok-k">match</span> <span class="tok-o">{</span>
  <span class="tok-k">case</span> <span class="tok-n">l</span><span class="tok-k">:</span> <span class="tok-kt">List</span><span class="tok-o">[</span><span class="tok-kt">a</span><span class="tok-o">]</span> <span class="tok-k">=&gt;</span>
     <span class="tok-c1">// lower case &#39;a&#39;, matches all types... what type is &#39;a&#39;?!</span>
<span class="tok-o">}</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>We don&#8217;t know the type of <code>a</code>, because of runtime type erasure. We know though that List is a type constructor, <code>* -&gt; *</code>, so there must have been some type, it could have used to construct a valid <code>List[T]</code>. This "some type", is the <strong>existentional type</strong>!</p>
</div>
<div class="paragraph">
<p>Scala provides a shortcut for it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-nc">List</span><span class="tok-o">[</span><span class="tok-k">_</span><span class="tok-o">]</span>
 <span class="tok-c1">//  ^ some type, no idea which one!</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s say you&#8217;re working with some Abstract Type Member, that in our case will be some Monad.
We want to force users of our class into using only <code>Cool</code> instances within this Monad, because for example,
only for these Types our Monad has any meaning. We can do this via Type Bounds on these <strong>Existential Type T</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">type</span> <span class="tok-kt">Monad</span><span class="tok-o">[</span><span class="tok-kt">T</span><span class="tok-o">]</span> <span class="tok-k">forSome</span> <span class="tok-o">{</span> <span class="tok-k">type</span> <span class="tok-kt">T</span> <span class="tok-k">&gt;:</span> <span class="tok-kt">Cool</span> <span class="tok-o">}</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="http://mikeslinn.blogspot.com/2012/08/scala-existential-types.html">http://mikeslinn.blogspot.com/2012/08/scala-existential-types.html</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dynamic-type"><a class="anchor" href="#dynamic-type"></a>Dynamic Type</h2>
<div class="sectionbody">
<div class="paragraph">
<p>I&#8217;ve had a hard time trying to decide if I should put this type into this vademecum of types or not. Lastly, I decided to add it, since it would make this collection of Type descriptions complete. So the question is, why did I hesistate so much?</p>
</div>
<div class="paragraph">
<p><strong>Scala allows us to have <strong>Dynamic Types</strong>, right inside of a Staticly/Strictly Typed language!</strong> Which is why I was considering to skip it, and leave a separate place for it&#8217;s description - as it&#8217;s basically "hacking around" all the descriptions you&#8217;ve seen above ;-) Let&#8217;s see it in action though, and how it fits into the Scala Type-ecosystem.</p>
</div>
<div class="paragraph">
<p>Imagine a class <code>JsonObject</code> which contains arbitrary JSON data. Let&#8217;s have methods, matching the keys of this JSON object, which would return an <code>Option[JValue]</code>, where a JValue can be another <code>JObject</code>, <code>JArray</code> or <code>JString</code> / <code>JNumber</code>. The usage would look like the example below.</p>
</div>
<div class="paragraph">
<p><strong>But before that, remember to enable this language feature in the given file (or REPL) via importing it.</strong>
There are a few features (like the experimental macros for example) that need to be explicitly imported in a file to be enabled. If you want to know more about these features, take a look at the [<code>scala.language</code>](<a href="http://www.scala-lang.org/api/current/index.html#scala.language$">http://www.scala-lang.org/api/current/index.html#scala.language$</a>) object or read the Scala Improvement Process 18 document ([SIP-18](<a href="https://docs.google.com/document/d/1nlkvpoIRkx7at1qJEZafJwthZ3GeIklTFhqmXMvTX9Q/edit)">https://docs.google.com/document/d/1nlkvpoIRkx7at1qJEZafJwthZ3GeIklTFhqmXMvTX9Q/edit)</a>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-c1">// remember, that we have to enable this language feature by importing it!</span>
<span class="tok-k">import</span> <span class="tok-nn">scala.language.dynamics</span>
</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-c1">// TODO: Has missing implementation</span>
<span class="tok-k">class</span> <span class="tok-nc">Json</span><span class="tok-o">(</span><span class="tok-n">s</span><span class="tok-k">:</span> <span class="tok-kt">String</span><span class="tok-o">)</span> <span class="tok-k">extends</span> <span class="tok-nc">Dynamic</span> <span class="tok-o">{</span>
  <span class="tok-o">???</span>
<span class="tok-o">}</span>

<span class="tok-k">val</span> <span class="tok-n">jsonString</span> <span class="tok-k">=</span> <span class="tok-s">&quot;&quot;&quot;</span>
<span class="tok-s">  {</span>
<span class="tok-s">    &quot;name&quot;: &quot;Konrad&quot;,</span>
<span class="tok-s">    &quot;favLangs&quot;: [&quot;Scala&quot;, &quot;Go&quot;, &quot;SML&quot;]</span>
<span class="tok-s">  }</span>
<span class="tok-s">&quot;&quot;&quot;</span>

<span class="tok-k">val</span> <span class="tok-n">json</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">Json</span><span class="tok-o">(</span><span class="tok-n">jsonString</span><span class="tok-o">)</span>

<span class="tok-k">val</span> <span class="tok-n">name</span><span class="tok-k">:</span> <span class="tok-kt">Option</span><span class="tok-o">[</span><span class="tok-kt">String</span><span class="tok-o">]</span> <span class="tok-k">=</span> <span class="tok-n">json</span><span class="tok-o">.</span><span class="tok-n">name</span>
<span class="tok-c1">// will compile (once we implement)!</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>So&#8230; how do we fit this into an otherwise Statically Typed language? The answer is simple - compiler rewrites and a <strong>special marker trait</strong>: <code>scala.Dynamic</code>.</p>
</div>
<div class="paragraph">
<p>Ok, end of rant and back to the basics. So&#8230; How do we use Dynamic? In fact, it&#8217;s used by implementing a few "magic" methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>applyDynamic</strong></p>
</li>
<li>
<p><strong>applyDynamicNamed</strong></p>
</li>
<li>
<p><strong>selectDynamic</strong></p>
</li>
<li>
<p><strong>updateDynamic</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s take a look (with examples, at each of them. We&#8217;ll start with the most "typical one", and move on to those which would allow the construct shown above (which didn&#8217;t (back then) compile) and make it work this time ;-)</p>
</div>
<div class="sect2">
<h3 id="applydynamic"><a class="anchor" href="#applydynamic"></a>applyDynamic</h3>
<div class="paragraph">
<p>Ok, our first magic method looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-c1">// applyDynamic example</span>
<span class="tok-k">object</span> <span class="tok-nc">OhMy</span> <span class="tok-k">extends</span> <span class="tok-nc">Dynamic</span> <span class="tok-o">{</span>
  <span class="tok-k">def</span> <span class="tok-n">applyDynamic</span><span class="tok-o">(</span><span class="tok-n">methodName</span><span class="tok-k">:</span> <span class="tok-kt">String</span><span class="tok-o">)(</span><span class="tok-n">args</span><span class="tok-k">:</span> <span class="tok-kt">Any*</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-n">s</span><span class="tok-s">&quot;&quot;&quot;|  methodName: $methodName,</span>
<span class="tok-s">                |args: ${args.mkString(&quot;,&quot;)}&quot;&quot;&quot;</span><span class="tok-o">.</span><span class="tok-n">stripMargin</span><span class="tok-o">)</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span>

<span class="tok-nc">OhMy</span><span class="tok-o">.</span><span class="tok-n">dynamicMethod</span><span class="tok-o">(</span><span class="tok-s">&quot;with&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;some&quot;</span><span class="tok-o">,</span> <span class="tok-mi">1337</span><span class="tok-o">)</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>So the signature of <strong>applyDynamic</strong> takes the method name and it&#8217;s arguments. So obviously we&#8217;d have to access them by their order. Very nice for building up some strings etc. Our implementation will only print what we want to know about the method being called. Did it really get the values/method name we would exect? The output would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-n">methodName</span><span class="tok-k">:</span> <span class="tok-kt">dynamicMethod</span><span class="tok-o">,</span>
  <span class="tok-n">args</span><span class="tok-k">:</span> <span class="tok-kt">with</span><span class="tok-o">,</span><span class="tok-n">some</span><span class="tok-o">,</span><span class="tok-mi">1337</span>
</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="applydynamicnamed"><a class="anchor" href="#applydynamicnamed"></a>applyDynamicNamed</h3>
<div class="paragraph">
<p>Ok, that was easy. But it didn&#8217;t give us too much control over the names of the parameters.
Wouldn&#8217;t it be nice if we could just write <code>JSON.node(nickname = "ktoso")</code>? Well&#8230; turns out we can!</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-c1">// applyDynamicNamed example</span>
<span class="tok-k">object</span> <span class="tok-nc">JSON</span> <span class="tok-k">extends</span> <span class="tok-nc">Dynamic</span> <span class="tok-o">{</span>
  <span class="tok-k">def</span> <span class="tok-n">applyDynamicNamed</span><span class="tok-o">(</span><span class="tok-n">name</span><span class="tok-k">:</span> <span class="tok-kt">String</span><span class="tok-o">)(</span><span class="tok-n">args</span><span class="tok-k">:</span> <span class="tok-o">(</span><span class="tok-kt">String</span><span class="tok-o">,</span> <span class="tok-kt">Any</span><span class="tok-o">)*)</span> <span class="tok-o">{</span>
    <span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-n">s</span><span class="tok-s">&quot;&quot;&quot;Creating a $name, for:\n &quot;${args.head._1}&quot;: &quot;${args.head._2}&quot; &quot;&quot;&quot;</span><span class="tok-o">)</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span>

<span class="tok-nc">JSON</span><span class="tok-o">.</span><span class="tok-n">node</span><span class="tok-o">(</span><span class="tok-n">nickname</span> <span class="tok-k">=</span> <span class="tok-s">&quot;ktoso&quot;</span><span class="tok-o">)</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>So this time instead of just a list of values, we also get their names. Thanks to this the response for this example will be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-nc">Creating</span> <span class="tok-n">a</span> <span class="tok-n">node</span><span class="tok-o">,</span> <span class="tok-k">for:</span>
<span class="tok-err">&quot;</span><span class="tok-kt">nickname</span><span class="tok-err">&quot;</span><span class="tok-kt">:</span> <span class="tok-err">&quot;</span><span class="tok-kt">ktoso</span><span class="tok-err">&quot;</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>I can easily imagine some pretty slick &lt;strong&gt;DLSs&lt;/strong&gt; being built around this!</p>
</div>
</div>
<div class="sect2">
<h3 id="selectdynamic"><a class="anchor" href="#selectdynamic"></a>selectDynamic</h3>
<div class="paragraph">
<p>Not it&#8217;s time for the more "unusual" methods. apply methods we&#8217;re pretty easy to understand. It&#8217;s just a method with some arbitrary name. But hey, isn&#8217;t almost everything in scala a method - or we can have a method on an object that would act as a field? Yeah, so let&#8217;s give it a try! &lt;strong&gt;We&#8217;ll use the example with applyDynamic here, and try to act like it has a method without ()&lt;/strong&gt;:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-nc">OhMy</span><span class="tok-o">.</span><span class="tok-n">name</span> <span class="tok-c1">// compilation error</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>Hey! Why didn&#8217;t this work with &lt;strong&gt;applyDynamic&lt;/strong&gt;? Yeah, you figured it out already I guess. Such methods (without <code>()</code>) are treated <strong>special</strong>, as they would usualy represent fields for example. <code>applyDynamic</code> won&#8217;t trigger on such calls.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s look at our first <code>selectDynamic</code> call:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">class</span> <span class="tok-nc">Json</span><span class="tok-o">(</span><span class="tok-n">s</span><span class="tok-k">:</span> <span class="tok-kt">String</span><span class="tok-o">)</span> <span class="tok-k">extends</span> <span class="tok-nc">Dynamic</span> <span class="tok-o">{</span>
  <span class="tok-k">def</span> <span class="tok-n">selectDynamic</span><span class="tok-o">(</span><span class="tok-n">name</span><span class="tok-k">:</span> <span class="tok-kt">String</span><span class="tok-o">)</span><span class="tok-k">:</span> <span class="tok-kt">Option</span><span class="tok-o">[</span><span class="tok-kt">String</span><span class="tok-o">]</span> <span class="tok-k">=</span>
    <span class="tok-n">parse</span><span class="tok-o">(</span><span class="tok-n">s</span><span class="tok-o">).</span><span class="tok-n">get</span><span class="tok-o">(</span><span class="tok-n">name</span><span class="tok-o">)</span>
<span class="tok-o">}</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>And this time when we execute <code>HasStuff.bananas</code> we&#8217;ll get "I have bananas!" as expected. Notice that here we return a value instead of printing it. It&#8217;s because it "acts as a field" this time around. But we could also return things (of arbitrary types) from any other method described here (&lt;strong&gt;applyDynamic&lt;/strong&gt; &lt;strong&gt;could return the string instead of printing it&lt;/strong&gt;).</p>
</div>
</div>
<div class="sect2">
<h3 id="updatedynamic"><a class="anchor" href="#updatedynamic"></a>updateDynamic</h3>
<div class="paragraph">
<p>What&#8217;s left you ask? Ask yourself the following question then: "Since I can act like a <code>Dynamic</code> object has some value in some field&#8230; What else should I be able to do with it?" My answer to that would be: "set it"! That&#8217;s what <code>updateDynamic</code> is used for. There is one special rule about <code>updateDynamic</code> though - it&#8217;s only valid if you also took care about selectDynamic - that&#8217;s why in the first example the code generated errors about both - select and update. For example if we&#8217;d implement only updateDynamic, we would get an error that selectDynamic was not implemented and it wouldn&#8217;t compile anyway. It makes sense in terms of plain semantics if you think about it.</p>
</div>
<div class="paragraph">
<p>When we&#8217;re done with this example, we can actually make the (wrong) code from the first code snippet work. The below snippet will be an implementation of what was shown on the first snippet on that other website, and this time it&#8217;ll actually work ;-)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">object</span> <span class="tok-nc">MagicBox</span> <span class="tok-k">extends</span> <span class="tok-nc">Dynamic</span> <span class="tok-o">{</span>
  <span class="tok-k">private</span> <span class="tok-k">var</span> <span class="tok-n">box</span> <span class="tok-k">=</span> <span class="tok-n">mutable</span><span class="tok-o">.</span><span class="tok-nc">Map</span><span class="tok-o">[</span><span class="tok-kt">String</span>, <span class="tok-kt">Any</span><span class="tok-o">]()</span>

  <span class="tok-k">def</span> <span class="tok-n">updateDynamic</span><span class="tok-o">(</span><span class="tok-n">name</span><span class="tok-k">:</span> <span class="tok-kt">String</span><span class="tok-o">)(</span><span class="tok-n">value</span><span class="tok-k">:</span> <span class="tok-kt">Any</span><span class="tok-o">)</span> <span class="tok-o">{</span> <span class="tok-n">box</span><span class="tok-o">(</span><span class="tok-n">name</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-n">value</span> <span class="tok-o">}</span>
  <span class="tok-k">def</span> <span class="tok-n">selectDynamic</span><span class="tok-o">(</span><span class="tok-n">name</span><span class="tok-k">:</span> <span class="tok-kt">String</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-n">box</span><span class="tok-o">(</span><span class="tok-n">name</span><span class="tok-o">)</span>
<span class="tok-o">}</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using this &lt;strong&gt;Dynamic&lt;/strong&gt; "&lt;strong&gt;MagicBox&lt;/strong&gt;" we can store items at arbitrary "fields" (well, they do seem like fields, even though they are not ;-)). An example run might look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-n">scala</span><span class="tok-o">&gt;</span> <span class="tok-nc">MagicBox</span><span class="tok-o">.</span><span class="tok-n">banana</span> <span class="tok-k">=</span> <span class="tok-s">&quot;banana&quot;</span>
<span class="tok-nc">MagicBox</span><span class="tok-o">.</span><span class="tok-n">banana</span><span class="tok-k">:</span> <span class="tok-kt">Any</span> <span class="tok-o">=</span> <span class="tok-n">banana</span>

<span class="tok-n">scala</span><span class="tok-o">&gt;</span> <span class="tok-nc">MagicBox</span><span class="tok-o">.</span><span class="tok-n">banana</span>
<span class="tok-n">res7</span><span class="tok-k">:</span> <span class="tok-kt">Any</span> <span class="tok-o">=</span> <span class="tok-n">banana</span>

<span class="tok-n">scala</span><span class="tok-o">&gt;</span> <span class="tok-nc">MagicBox</span><span class="tok-o">.</span><span class="tok-n">unknown</span>
<span class="tok-n">java</span><span class="tok-o">.</span><span class="tok-n">util</span><span class="tok-o">.</span><span class="tok-nc">NoSuchElementException</span><span class="tok-k">:</span> <span class="tok-kt">key</span> <span class="tok-kt">not</span> <span class="tok-kt">found:</span> <span class="tok-kt">unknown</span>
</code></pre>
</div>
</div>
<div class="paragraph">
<p>By the way&#8230; are you curious how Dynamic &lt;a href="https://github.com/scala/scala/blob/master/src/library/scala/Dynamic.scala"&gt;[source code]&lt;/a&gt; is implemented? The fun part here is that the trait Dynamic, does absolutely nothing by itself - it&#8217;s "empty", just a marker interface. Obviously all the heavylifting (<strong>call-site-rewriting</strong>) is done by the compiler here.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="type-lambda"><a class="anchor" href="#type-lambda"></a>Type Lambda</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In type lambda&#8217;s we&#8217;ll be using <strong>Path Dependent</strong> as well as <strong>Structural Types</strong>, so if you skipped that sections you may want to go back to it.</p>
</div>
<div class="paragraph">
<p>Before we look at Type Lambdas, let&#8217;s take a step back and remind ourselfs a bit about functions and currying.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code class="scala language-scala"><span class="tok-k">class</span> <span class="tok-nc">EitherMonad</span><span class="tok-o">[</span><span class="tok-kt">A</span><span class="tok-o">]</span> <span class="tok-nc">extends</span> <span class="tok-nc">Monad</span><span class="tok-o">[({</span><span class="tok-k">type</span> <span class="tok-kt"></span><span class="tok-o">[</span><span class="tok-kt"></span><span class="tok-o">]</span> <span class="tok-kt">=</span> <span class="tok-kt">Either</span><span class="tok-o">[</span><span class="tok-kt">A</span>, <span class="tok-kt"></span><span class="tok-o">]})</span><span class="tok-k">#</span><span class="tok-kt"></span><span class="tok-o">]</span> <span class="tok-o">{</span>
  <span class="tok-k">def</span> <span class="tok-n">point</span><span class="tok-o">[</span><span class="tok-kt">B</span><span class="tok-o">](</span><span class="tok-n">b</span><span class="tok-k">:</span> <span class="tok-kt">B</span><span class="tok-o">)</span><span class="tok-k">:</span> <span class="tok-kt">Either</span><span class="tok-o">[</span><span class="tok-kt">A</span>, <span class="tok-kt">B</span><span class="tok-o">]</span>
  <span class="tok-k">def</span> <span class="tok-n">bind</span><span class="tok-o">[</span><span class="tok-kt">B</span>, <span class="tok-kt">C</span><span class="tok-o">](</span><span class="tok-n">m</span><span class="tok-k">:</span> <span class="tok-kt">Either</span><span class="tok-o">[</span><span class="tok-kt">A</span>, <span class="tok-kt">B</span><span class="tok-o">])(</span><span class="tok-n">f</span><span class="tok-k">:</span> <span class="tok-kt">B</span> <span class="tok-o">=&gt;</span> <span class="tok-nc">Either</span><span class="tok-o">[</span><span class="tok-kt">A</span>, <span class="tok-kt">C</span><span class="tok-o">])</span><span class="tok-k">:</span> <span class="tok-kt">Either</span><span class="tok-o">[</span><span class="tok-kt">A</span>, <span class="tok-kt">C</span><span class="tok-o">]</span>
<span class="tok-o">}</span>
</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="links-and-kudos"><a class="anchor" href="#links-and-kudos"></a>Links and Kudos</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Obvisouly this vademecum required quite a bit of reseach and double-checking, so here are all the links I&#8217;ve found helpful (and you might too).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Twitter&#8217;s Scala School: <a href="http://twitter.github.io/scala_school">http://twitter.github.io/scala_school</a> quite a bit of Scala concepts. Which helped me a lot in nicely explaining Variance (nicest explanation I found, since "ever").</p>
</li>
<li>
<p>Very old, but still valid explanation of Universal Types: <a href="http://www.scala-lang.org/old/node/128">http://www.scala-lang.org/old/node/128</a></p>
</li>
<li>
<p>Existential Types by D.R. MacIver: <a href="http://www.drmaciver.com/2008/03/existential-types-in-scala/">http://www.drmaciver.com/2008/03/existential-types-in-scala/</a></p>
</li>
<li>
<p>Scala Doc: <a href="http://www.scala-lang.org/api/current/index.html">http://www.scala-lang.org/api/current/index.html</a></p>
</li>
<li>
<p>Wikipedia on the Diamond Problem: <a href="http://en.wikipedia.org/wiki/Diamond_problem#The_diamond_problem">http://en.wikipedia.org/wiki/Diamond_problem#The_diamond_problem</a></p>
</li>
<li>
<p>Safari Books online about Type Linearization: <a href="http://blog.safaribooksonline.com/2013/05/30/traits-how-scala-tames-multiple-inheritance/">http://blog.safaribooksonline.com/2013/05/30/traits-how-scala-tames-multiple-inheritance/</a></p>
</li>
<li>
<p>One of the first blogs about Phantom Types in Scala: <a href="http://blog.rafaelferreira.net/2008/07/type-safe-builder-pattern-in-scala.html">http://blog.rafaelferreira.net/2008/07/type-safe-builder-pattern-in-scala.html</a></p>
</li>
<li>
<p>Rogue (where I occasionally PullRequest too) is a great example of using Phantom Types: <a href="http://engineering.foursquare.com/2011/01/31/going-rogue-part-2-phantom-types/">http://engineering.foursquare.com/2011/01/31/going-rogue-part-2-phantom-types/</a></p>
</li>
<li>
<p>Great StackOverflow answer by <strong>Kriss Nuttycombe</strong> about Type Lambdas: <a href="http://stackoverflow.com/questions/8736164/what-are-type-lambdas-in-scala-and-what-are-their-benefits">http://stackoverflow.com/questions/8736164/what-are-type-lambdas-in-scala-and-what-are-their-benefits</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>I would especialy like to thank all proof-readers and reviewers tha that have helped me with polishing this article and giving valuable feedback many many times:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Sergio &#8230;.</p>
</li>
<li>
<p>Andrzej</p>
</li>
<li>
<p>Josh of Typesafe (?)</p>
</li>
<li>
<p>The awesome guys from Softwaremill</p>
</li>
<li>
<p>The awesome guys from VirtusLab</p>
</li>
<li>
<p>TODO TODO</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2013-11-15 19:52:52 GMT
</div>
</div>
</body>
</html>